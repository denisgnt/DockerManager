# โ ะงะตะบะปะธัั ัะฐะทะฒะตัััะฒะฐะฝะธั Docker Manager

## ะัะต ะธัะฟัะฐะฒะปะตะฝะธั ะฟัะธะผะตะฝะตะฝั

### 1. โ Express 5.x ัะพะฒะผะตััะธะผะพััั
- **ะคะฐะนะป:** `server/index.js`
- **ะัะพะฑะปะตะผะฐ:** Wildcard ะฟััั `'*'` ะฝะต ะฟะพะดะดะตัะถะธะฒะฐะตััั
- **ะะตัะตะฝะธะต:** ะัะฟะพะปัะทะพะฒะฐะฝ middleware ะฒะผะตััะพ `app.get('*')`

### 2. โ ะัะพะฑัะพั ะฟะพััะพะฒ Docker
- **ะคะฐะนะป:** `docker-compose.yml`
- **ะัะปะพ:** `3011:3011` ะธ `5005:5005`
- **ะกัะฐะปะพ:** `3011:5005`
- **ะัะธัะธะฝะฐ:** ะ production ัะพะปัะบะพ Express ะฝะฐ ะฟะพััั 5005

### 3. โ Dockerfile ะพะฟัะธะผะธะทะฐัะธั
- **ะคะฐะนะป:** `Dockerfile`
- **ะัะปะพ:** `EXPOSE 3011 5005`
- **ะกัะฐะปะพ:** `EXPOSE 5005`

### 4. โ Vite host ะดะปั Docker
- **ะคะฐะนะป:** `vite.config.js`
- **ะะพะฑะฐะฒะปะตะฝะพ:** `host: '0.0.0.0'`
- **ะัะธัะธะฝะฐ:** ะะปั ะดะพัััะฟะฐ ะธะทะฒะฝะต ะฒ dev ัะตะถะธะผะต

### 5. โ Socket.IO ะดะธะฝะฐะผะธัะตัะบะพะต ะฟะพะดะบะปััะตะฝะธะต
- **ะคะฐะนะป:** `src/components/ContainerLogs.jsx`
- **ะัะปะพ:** `http://localhost:5005` (ัะฐัะดะบะพะด)
- **ะกัะฐะปะพ:** `window.location.origin` ะฒ production
- **ะัะธัะธะฝะฐ:** ะะฐะฑะพัะฐ ะฝะฐ ะปัะฑะพะผ ัะพััะต

### 6. โ Package.json license
- **ะคะฐะนะป:** `package.json`
- **ะะพะฑะฐะฒะปะตะฝะพ:** `"license": "MIT"`

---

## ๐ ะะพะผะฐะฝะดั ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั

### ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟะตัะตัะฑะพัะบะฐ (ัะตะบะพะผะตะฝะดัะตััั):
```bash
./docker_rebuild.sh
```

### ะััะฝะฐั ะฟะตัะตัะฑะพัะบะฐ:
```bash
# 1. ะััะฐะฝะพะฒะธัั ะธ ัะดะฐะปะธัั ะบะพะฝัะตะนะฝะตั
docker stop docker-manager
docker rm docker-manager

# 2. ะฃะดะฐะปะธัั ััะฐััะน ะพะฑัะฐะท
docker rmi dockermanager-docker-manager

# 3. ะะตัะตัะพะฑัะฐัั ะฑะตะท ะบััะฐ
docker compose build --no-cache

# 4. ะะฐะฟัััะธัั
docker compose up -d

# 5. ะัะพะฒะตัะธัั ะปะพะณะธ
docker logs -f docker-manager
```

---

## ๐ ะัะพะฒะตัะบะฐ ะฟะพัะปะต ัะฐะทะฒะตัััะฒะฐะฝะธั

### 1. ะัะพะฒะตัะบะฐ ััะฐัััะฐ ะบะพะฝัะตะนะฝะตัะฐ
```bash
docker ps | grep docker-manager
```
**ะะถะธะดะฐะตััั:** ะะพะฝัะตะนะฝะตั ะทะฐะฟััะตะฝ (status: Up)

### 2. ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
```bash
docker logs docker-manager | head -20
```
**ะะพะปะถะฝะพ ะฑััั:**
```
Server is running on port 5005
Docker API: http://10.174.18.242:2375
Scripts directory: /app/scripts
Environment: production
```

**ะะ ะดะพะปะถะฝะพ ะฑััั:**
- โ `concurrently`
- โ `Environment: development`
- โ `vite`

### 3. ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ
```bash
docker port docker-manager
```
**ะะถะธะดะฐะตััั:**
```
5005/tcp -> 0.0.0.0:3011
```

### 4. ะัะพะฒะตัะบะฐ ะฒะตะฑ-ะธะฝัะตััะตะนัะฐ
ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต: http://10.174.18.242:3011/

**ะัะพะฒะตัััะต:**
- โ ะกััะฐะฝะธัะฐ ะทะฐะณััะถะฐะตััั
- โ ะกะฟะธัะพะบ ะบะพะฝัะตะนะฝะตัะพะฒ ะพัะพะฑัะฐะถะฐะตััั
- โ ะะฝะพะฟะบะธ ัะฐะฑะพัะฐัั (Start/Stop/Restart)
- โ ะะพะณะธ ะบะพะฝัะตะนะฝะตัะฐ ะพัะบััะฒะฐัััั
- โ Socket.IO ะฟะพะดะบะปััะฐะตััั (ััะฐััั: "โ ะะพะดะบะปััะตะฝะพ")

### 5. ะัะพะฒะตัะบะฐ Socket.IO ะฒ ะฑัะฐัะทะตัะต
**DevTools โ Console:**
```
Connecting to Socket.IO: http://10.174.18.242:3011
Connected to Socket.IO server
```

**DevTools โ Network โ WS:**
- ะะพะปะถะฝะพ ะฑััั WebSocket ะฟะพะดะบะปััะตะฝะธะต ะบ `/socket.io/`
- Status: `101 Switching Protocols`

### 6. ะัะพะฒะตัะบะฐ API
```bash
curl http://10.174.18.242:3011/api/containers
```
**ะะถะธะดะฐะตััั:** JSON ัะฟะธัะพะบ ะบะพะฝัะตะนะฝะตัะพะฒ

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ ะฟะพัะปะต ัะฐะทะฒะตัััะฒะฐะฝะธั

```
DockerManager/
โโโ dist/                          # ะกะพะฑัะฐะฝะฝัะน ััะพะฝัะตะฝะด (ะฒ Docker)
โ   โโโ index.html
โ   โโโ assets/
โโโ server/                        # Backend
โ   โโโ index.js                  # Express + Socket.IO
โ   โโโ appsettings.js
โโโ src/                          # ะััะพะดะฝะธะบะธ ััะพะฝัะตะฝะดะฐ
โ   โโโ App.jsx
โ   โโโ main.jsx
โ   โโโ components/
โ       โโโ ContainerInfo.jsx
โ       โโโ ContainerList.jsx
โ       โโโ ContainerLogs.jsx    # โ ะัะฟัะฐะฒะปะตะฝ Socket.IO
โโโ docker-compose.yml            # โ ะัะฟัะฐะฒะปะตะฝ ะฟัะพะฑัะพั ะฟะพััะพะฒ
โโโ Dockerfile                    # โ ะะฟัะธะผะธะทะธัะพะฒะฐะฝ
โโโ vite.config.js               # โ ะะพะฑะฐะฒะปะตะฝ host: 0.0.0.0
โโโ package.json                 # โ ะะพะฑะฐะฒะปะตะฝะฐ license
โโโ docker_rebuild.sh            # ๐ ะกะบัะธะฟั ะฟะตัะตัะฑะพัะบะธ
โโโ REBUILD_INSTRUCTIONS.md      # ๐ ะะฝััััะบัะธะธ
โโโ SOCKET_IO_CONFIG.md          # ๐ ะะพะบัะผะตะฝัะฐัะธั Socket.IO
โโโ ARCHITECTURE_MODES.md        # ๐ ะััะธัะตะบัััะฐ
โโโ DEPLOY_CHECKLIST.md          # ๐ ะญัะพั ัะฐะนะป
```

---

## ๐ง ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

### ะ docker-compose.yml:
```yaml
environment:
  - VITE_DOCKER_API_HOST=10.174.18.242
  - VITE_DOCKER_API_PORT=2375
  - VITE_BACKEND_PORT=5005
  - SCRIPTS_DIR=/app/scripts
  - VITE_APP_NAME=Docker Manager DEVELOP
  - NODE_ENV=production
```

### ะะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ (.env):
```env
VITE_PORT=3011
VITE_BACKEND_PORT=5005
VITE_DOCKER_API_HOST=10.174.18.242
VITE_DOCKER_API_PORT=2375
VITE_APP_NAME=Docker Manager Local
```

---

## ๐ Troubleshooting

### ะัะพะฑะปะตะผะฐ: ะะพัั 3011 ะฝะตะดะพัััะฟะตะฝ

**ะะตัะตะฝะธะต 1:** ะัะพะฒะตัััะต, ะทะฐะฟััะตะฝ ะปะธ ะบะพะฝัะตะนะฝะตั
```bash
docker ps | grep docker-manager
```

**ะะตัะตะฝะธะต 2:** ะัะพะฒะตัััะต ะปะพะณะธ ะฝะฐ ะพัะธะฑะบะธ
```bash
docker logs docker-manager
```

**ะะตัะตะฝะธะต 3:** ะัะพะฒะตัััะต, ะฝะต ะทะฐะฝัั ะปะธ ะฟะพัั
```bash
lsof -i :3011  # ะธะปะธ netstat -tuln | grep 3011
```

### ะัะพะฑะปะตะผะฐ: Socket.IO ะฝะต ะฟะพะดะบะปััะฐะตััั

**ะะตัะตะฝะธะต 1:** ะัะบัะพะนัะต DevTools โ Console, ะฟัะพะฒะตัััะต URL ะฟะพะดะบะปััะตะฝะธั
```
Connecting to Socket.IO: <ะดะพะปะถะตะฝ ะฑััั ะฟัะฐะฒะธะปัะฝัะน URL>
```

**ะะตัะตะฝะธะต 2:** ะัะพะฒะตัััะต Network โ WS ะฝะฐ ะฝะฐะปะธัะธะต WebSocket ะฟะพะดะบะปััะตะฝะธั

**ะะตัะตะฝะธะต 3:** ะะตัะตัะพะฑะตัะธัะต ั ัะธััะพะณะพ ะปะธััะฐ
```bash
./docker_rebuild.sh
```

### ะัะพะฑะปะตะผะฐ: API ะฝะต ัะฐะฑะพัะฐะตั

**ะะตัะตะฝะธะต 1:** ะัะพะฒะตัััะต, ััะพ Express ะทะฐะฟััะตะฝ
```bash
docker logs docker-manager | grep "running on port"
```

**ะะตัะตะฝะธะต 2:** ะัะพะฒะตัััะต ะดะพัััะฟะฝะพััั ะฝะฐะฟััะผัั
```bash
curl http://10.174.18.242:3011/api/containers
```

### ะัะพะฑะปะตะผะฐ: ะกัะฐััะน ะบะพะด ะฟะพัะปะต ะฟะตัะตัะฑะพัะบะธ

**ะัะธัะธะฝะฐ:** Docker ะธัะฟะพะปัะทัะตั ะบัั

**ะะตัะตะฝะธะต:**
```bash
docker stop docker-manager
docker rm docker-manager
docker rmi dockermanager-docker-manager
docker compose build --no-cache
docker compose up -d
```

---

## ๐ ะััะธัะตะบัััะฐ Production

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะัะฐัะทะตั                                โ
โ  http://10.174.18.242:3011/            โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โ HTTP/WS
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Docker Host (10.174.18.242)            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  Docker Container                 โ  โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ  โ
โ  โ  โ  Express Server (port 5005) โ  โ  โ
โ  โ  โ  โโ Static: /dist/*         โ  โ  โ
โ  โ  โ  โโ API: /api/*             โ  โ  โ
โ  โ  โ  โโ Socket.IO: /socket.io   โ  โ  โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ  โ
โ  โ  Port mapping: 3011 โ 5005        โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โจ ะะพัะพะฒะพ!

ะะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ะฒัะตั ัะฐะณะพะฒ:
1. โ ะัะธะปะพะถะตะฝะธะต ะดะพัััะฟะฝะพ ะฟะพ http://10.174.18.242:3011/
2. โ Socket.IO ัะฐะฑะพัะฐะตั
3. โ API ัะฐะฑะพัะฐะตั
4. โ ะะพะณะธ ะบะพะฝัะตะนะฝะตัะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
5. โ ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะตะนะฝะตัะฐะผะธ
6. โ ะัะฟะพะปะฝะตะฝะธะต ัะบัะธะฟัะพะฒ

**ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั:**
- ะะพะณะธ: `docker logs -f docker-manager`
- ะกัะฐััั: `docker ps | grep docker-manager`
- ะััะฐะฝะพะฒะธัั: `docker stop docker-manager`
- ะะตัะตะทะฐะฟัััะธัั: `docker restart docker-manager`
- ะะตัะตัะพะฑัะฐัั: `./docker_rebuild.sh`
